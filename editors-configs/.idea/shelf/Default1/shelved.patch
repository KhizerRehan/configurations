Index: src/app/core/services/transaction.service.ts
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { NotificationsService } from 'angular2-notifications';\nimport { ValidationModal } from '../../shared/components/modals/validation-modal/validation-modal.component';\nimport { ElementHandlerService } from './element-handler.service';\nimport { EndpointsService } from './endpoints';\nimport { HttpApiService } from './http-api.service';\nimport { RequestBuilder } from './request.builder';\nimport { ResponseCode } from './ResponseCode';\nimport { SharedDataService } from './shared-data.service';\n\n@Injectable()\nexport class TransactionService {\n\n  private static self: any;\n  transactionId: number;\n  transactionPromise: any;\n  private _isReadOnlyMode: boolean;\n\n  public static clearTransactions() {\n    TransactionService.self.transactionId = null;\n    TransactionService.self.transactionPromise = null;\n    TransactionService.self.clearTransactionsInCookie();\n  }\n\n  constructor(private httpService: HttpApiService,\n              private endpoints: EndpointsService,\n              private router: Router,\n              private elementHandler: ElementHandlerService,\n              private notificationService: NotificationsService,\n              private sharedData: SharedDataService) {\n    TransactionService.self = this;\n    this.loadTransactionsFromCookie();\n    this.sharedData.getClearTransaction()\n      .subscribe(value => {\n        if (value) {\n          TransactionService.clearTransactions();\n        }\n      });\n  }\n\n  get isReadOnlyMode(): boolean {\n    return this._isReadOnlyMode;\n  }\n\n  getReadTransaction() {\n    if (this.transactionPromise) {\n      return this.transactionPromise;\n    }\n    this.transactionPromise = new Promise((resolve, reject) => {\n      if (this.transactionId) {\n        this.transactionPromise = null;\n        resolve(this.transactionId);\n      } else {\n        this.httpService.postRequest(RequestBuilder.withStartTransaction({}))\n          .subscribe(transaction => {\n              this.transactionId = transaction.data.transactionId;\n              this.transactionPromise = null;\n              this.saveTransactionsInCookie();\n              resolve(this.transactionId);\n            },\n            error => {\n              console.log(error);\n              this.transactionPromise = null;\n              reject(error);\n            });\n      }\n    });\n    return this.transactionPromise;\n  }\n\n  getWriteTransaction(path: string = '', flushElements: boolean = true) {\n    if (flushElements) {\n      // TODO: find an alternative for flushing elements\n      this.elementHandler.flushElements();\n    }\n    return new Promise((resolve, reject) => {\n      if (this.isReadOnlyMode) {\n        // TODO: show warning notification\n      }\n      if (this.transactionId) {\n        resolve(this.transactionId);\n      }\n      else {\n        this.httpService.postRequest(RequestBuilder.withStartTransaction({'mode': 'write', 'path': path}))\n          .subscribe(transaction => {\n              this.transactionId = transaction.data.transactionId;\n              this.transactionPromise = null;\n              this.saveTransactionsInCookie();\n              resolve(this.transactionId);\n            },\n            error => {\n              console.log(error);\n              reject(error);\n            });\n      }\n    });\n  }\n\n  commitTransaction(comment: string) {\n    return new Promise((resolve, reject) => {\n      if (this.sharedData.getChangeCount() === 0) {\n        // Notification.warning(\"No changes to save\");\n        console.log('no changes to commit');\n        resolve(true);\n      }\n      else {\n        this.httpService.postRequest(RequestBuilder.withValidateTransaction(this.transactionId))\n          .subscribe(validateResponse => {\n              if (validateResponse.code !== ResponseCode.OK) {\n                ValidationModal.open('Validation Failed', validateResponse);\n                resolve(false);\n              }\n              else {\n                this.httpService.postRequest(RequestBuilder.withCommitTransaction(comment, this.transactionId))\n                  .subscribe(commitResponse => {\n                      if (commitResponse.code !== ResponseCode.OK) {\n                        reject(commitResponse);\n                      }\n                      else {\n                        this.sharedData.clearChangeCount();\n                        TransactionService.clearTransactions();\n                        this.showNotification('Changes deployed successfully');\n                        resolve(true);\n                      }\n                    },\n                    error => reject(error));\n              }\n            },\n            error => reject(error));\n      }\n    });\n  }\n\n  loadProfiles(url: string, forceReload?: boolean) {\n    return new Promise((resolve, reject) => {\n      if (this.sharedData.getProfiles() && !forceReload) {\n        resolve(this.sharedData.getProfiles());\n      } else {\n        this.getReadTransaction().then(transactionId => {\n          this.httpService.postRequest(RequestBuilder.withGetListKeys(url, transactionId))\n            .map(result => {\n              const data: Array<any> = [];\n              result.data.keys.forEach(item => {\n                data.push(item);\n              });\n              return data;\n            })\n            .subscribe(response => {\n                this.sharedData.setProfiles(response);\n                resolve(this.sharedData.getProfiles());\n              },\n              error => {\n                console.log(error);\n                reject(error);\n              });\n        });\n      }\n    });\n  }\n\n  abort(callback: string, self) {\n    if (this.sharedData.getChangeCount() === 0) {\n      return false;\n    }\n    this.httpService.postRequest(RequestBuilder.withAbortTransaction(this.transactionId))\n      .subscribe(res => {\n        TransactionService.clearTransactions();\n        this.sharedData.clearChangeCount();\n        this.sharedData.setProfiles(null);\n        this.sharedData.setProfile(null);\n        this.elementHandler.flushElements();\n        this.loadProfiles(this.endpoints.getProfilesUrl(null))\n          .then(response => {\n            this.showNotification('Changes discarded successfully');\n          });\n        self[callback]();\n        this.router.navigateByUrl('/');\n      });\n\n    return true;\n  }\n\n  validate() {\n    if (this.sharedData.getChangeCount() === 0) {\n      // Notification.warning(\"No changes to save\");\n      console.log('no changes to commit');\n      return null;\n    }\n    this.httpService.postRequest(RequestBuilder.withValidateTransaction(this.transactionId))\n      .subscribe(validateResponse => {\n          if (validateResponse.code !== ResponseCode.OK) {\n            ValidationModal.open('Validation Failed', validateResponse);\n            return false;\n          }\n          else {\n            ValidationModal.open('Validation Succeeded', 'Validation Completed Successfully');\n            return true;\n          }\n        },\n        error => {\n          ValidationModal.open('Validation Failed', JSON.parse(error._body));\n          return false;\n        });\n  }\n\n  loadTransactionsFromCookie() {\n    const tid = SharedDataService.readCookie('tid');\n    this.transactionId = +tid;\n    const mode = SharedDataService.readCookie('mode');\n    this._isReadOnlyMode = mode === 'read';\n  }\n\n  saveTransactionsInCookie() {\n    SharedDataService.createCookie('tid', this.transactionId);\n  }\n\n  clearTransactionsInCookie() {\n    this.sharedData.clearChangeCount();\n    SharedDataService.deleteCookie('tid');\n  }\n\n  private showNotification(msg: string, title: string = '') {\n    this.notificationService.remove();\n    this.notificationService.success(title, msg, {\n      timeOut: 5000,\n      showProgressBar: false,\n      clickToClose: true\n    });\n  }\n\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/app/core/services/transaction.service.ts	(revision 05849a5cdc1eac7ea803874310c7b841c91ba6bd)
+++ src/app/core/services/transaction.service.ts	(date 1539006483000)
@@ -78,9 +78,9 @@
       if (this.isReadOnlyMode) {
         // TODO: show warning notification
       }
-      if (this.transactionId) {
-        resolve(this.transactionId);
-      }
+      // if (this.transactionId) {
+      //   resolve(this.transactionId);
+      // }
       else {
         this.httpService.postRequest(RequestBuilder.withStartTransaction({'mode': 'write', 'path': path}))
           .subscribe(transaction => {
Index: src/app/main.component.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><nav class=\"navigation clearfix\" role=\"navigation\">\n\n  <ul class=\"dashboard-menu dashboard-menu-left dashboard-menu-perspectives list-reset mb0 clearfix\">\n    <li class=\"dashboard-logo\">\n      <a [routerLink]=\"['/']\"><img src=\"assets/images/curity-logo-landscape-white.svg\"></a>\n    </li>\n    <li>\n      <div class=\"dropdown dropdown-system\">\n        <button class=\"dropbtn\" [routerLink]=\"['/environment']\">\n        <i class=\"icon ion-ios-gear-outline inlineicon\"></i>\n        <span class=\"dropbtn-label dropbtn-label-system\">System</span>\n        </button>\n      </div>\n\n    </li>\n    <li>\n      <div class=\"dropdown dropdown-authentication\">\n        <button class=\"dropbtn\" (mouseover)=\"loadProfiles()\">\n        <i class=\"icon ion-ios-unlocked-outline inlineicon\"></i>\n        <span class=\"dropbtn-labe dropbtn-label-authentication\">Authentication</span>\n        </button>\n        <div class=\"dropdown-content\">\n          <a class=\"dropdown-create dropdown-create-separator-bottom\" (click)=\"createAuthenticationProfile()\"><i class=\"icon ion-plus-circled inlineicon\"></i> New profile</a>\n          <div *ngFor=\"let profile of result\">\n            <a *ngIf=\"profile.type.indexOf('authentication')>-1\"\n               [ngClass]=\"{'active': profile.id === currentProfileId}\"\n               (click)=\"updateData(profile, '/profile/authentication')\">{{profile.id}}\n            </a>\n          </div>\n        </div>\n      </div>\n    </li>\n    <li>\n      <div class=\"dropdown dropdown-oauth\">\n        <button class=\"dropbtn\" (mouseover)=\"loadProfiles()\">\n          <i class=\"icon ion-ios-pricetag-outline inlineicon\"></i>\n          <span class=\"dropbtn-label dropbtn-label-token\">Token Service</span>\n        </button>\n        <div class=\"dropdown-content\">\n          <a class=\"dropdown-create dropdown-create-separator-bottom\" (click)=\"createOAuthProfile()\"><i class=\"icon ion-plus-circled inlineicon\"></i>New profile</a>\n          <div *ngFor=\"let profile of result\">\n            <a *ngIf=\"profile.type.indexOf('oauth')>-1\"\n               [ngClass]=\"{'active': profile.id === currentProfileId}\"\n               (click)=\"updateData(profile, '/profile/oauth')\">{{profile.id}}\n            </a>\n          </div>\n        </div>\n      </div>\n    </li>\n\n    <li>\n      <div class=\"dropdown dropdown-user\">\n        <button class=\"dropbtn\" (mouseover)=\"loadProfiles()\">\n        <i class=\"icon ion-ios-person-outline inlineicon\"></i>\n        <span class=\"dropbtn-label dropbtn-label-user\">User Management</span>\n        </button>\n        <div class=\"dropdown-content\">\n          <a class=\"dropdown-create dropdown-create-separator-bottom\" (click)=\"createUserManagementProfile()\"><i class=\"icon ion-plus-circled inlineicon\"></i>New profile</a>\n          <div *ngFor=\"let profile of result\">\n            <a *ngIf=\"profile.type.indexOf('user-management-service')>-1\"\n               [ngClass]=\"{'active': profile.id === currentProfileId}\"\n               (click)=\"updateData(profile, '/profile/user-management')\">{{profile.id}}\n            </a>\n          </div>\n        </div>\n      </div>\n    </li>\n  </ul>\n  <ul class=\"dashboard-menu dashboard-menu-right list-reset mb0 clearfix\">\n    <li class=\"dashboard-menu-item\">\n\n    <div class=\"dropdown dropdown-deploy\">\n      <button class=\"dropbtn\" id=\"deploy-btn\" [ngClass]=\"{'active': changeCount > 0}\">\n        <i class=\"icon ion-network inline-icon\"></i>\n        <span class=\"dropbtn-label dropbtn-label-changes\">Changes</span>\n        <span class=\"dropdown-deploy-notice\"></span>\n      </button>\n      <div class=\"dropdown-content\">\n        <a class=\"dropdown-create\" (click)=\"confirmDeploy()\" [ngClass]=\"{'dropdown-inactive' : changeCount==0}\">Commit</a>\n        <a class=\"dropdown-create\" id=\"validate-btn\" (click)=\"validateTransaction()\" [ngClass]=\"{'dropdown-inactive' : changeCount==0}\">Validate</a>\n        <a class=\"dropdown-create\" (click)=\"abort()\" [ngClass]=\"{'dropdown-inactive' : changeCount==0}\">Cancel</a>\n        <a class=\"dropdown-create\" (click)=\"showChanges()\" [ngClass]=\"{'dropdown-inactive' : changeCount==0}\">Pending Changes</a>\n        <a class=\"dropdown-create dropdown-create-separator\" (click)=\"rollback()\">History</a>\n        <a class=\"dropdown-create\" (click)=\"downloadConfig()\">Download</a>\n      </div>\n    </div>\n    </li>\n    <li class=\"dashboard-menu-item\">\n\n      <div class=\"dropdown dropdown-profile\">\n        <button class=\"dropbtn\">\n        <i class=\"icon ion-person\"></i>\n        <span class=\"dropbtn-label dropbtn-label-profile\">Profile</span>\n        </button>\n        <div class=\"dropdown-content\">\n          <a [routerLink]=\"['/users']\" class=\"cursor-pointer\"><i class=\"icon ion-person-stalker inlineicon\"></i>Manage users</a>\n          <a id=\"logout-btn\" (click)=\"logout()\" class=\"cursor-pointer\"><i class=\"icon ion-power inlineicon\"></i>Logout</a>\n        </div>\n    </div>\n\n    </li>\n\n    <li class=\"facilities-menu\">\n      <div class=\"facilities\" (outsideClick)=\"onOffClick()\">\n        <button class=\"dropbtn\" [ngClass]=\"{active: showFacilities}\" (click)=\"onFacilitiesBtnClick()\">\n          <span class=\"button button-primary button-small\">\n          <i class=\"icon ion-android-more-vertical inlineicon\"></i> Facilities\n          </span>\n        </button>\n\n        <div class=\"facilities-dropdown-holder\" [ngClass]=\"{active: showFacilities}\" *ngIf=\"showFacilities\">\n          <div class=\"field-group\">\n            <input type=\"search\" class=\"field col-12\" [(ngModel)]=\"tempFacilites.searchValue\" name=\"searchValue\"\n                   (focus)=\"searchClearBtn.style.display = tempFacilites.searchValue ? 'block' : 'none'\"\n                   (input)=\"search(tempFacilites.searchValue); searchClearBtn.style.display = $event.target.value ? 'block' : 'none'\"\n                   placeholder=\"Find facilities by id or name\" focusElement>\n            <button class=\"show-password\" type=\"button\" style=\"display: none\" #searchClearBtn\n                    (click)=\"tempFacilites.searchValue = ''; search(''); searchClearBtn.style.display = 'none'\">\n              <i class=\"icon ion-close-circled\"></i></button>\n          </div>\n          <ul class=\"facilities-dropdown\">\n            <li>\n              <a><i class=\"icon ion-datasource inlineicon facilities-dropdown-icon\"></i>Data Sources\n                <label *ngIf=\"facilites.dataSources\">({{facilites.dataSources.length}})</label>\n                <i class=\"icon ion-chevron-down\" (click)=\"facilitiesMenuOptions.activeDataSource=!facilitiesMenuOptions.activeDataSource\"></i>\n                <span class=\"facilities-create\" (click)=\"createFacilities('dataSources')\">\n                  <i class=\"icon ion-android-add-circle inlineicon\"></i>New</span></a>\n              <ul class=\"facilities-dropdown-list\" [ngClass]=\"{expanded: !facilitiesMenuOptions.activeDataSource}\">\n                <li *ngFor=\"let item of facilites.dataSources\">\n                  <a>{{item}} <span class=\"facilities-edit-keystore facilities-keystore facilities-edit\" (click)=\"editFacilities('dataSources', item)\">\n                    <i class=\"icon ion-edit inlineicon\"></i>Edit</span>\n                    <span class=\"facilities-keystore facilities-edit\" (click)=\"deleteFacility('dataSources', item)\">\n                    <i class=\"icon ion-android-delete inlineicon\"></i>Delete</span>\n                  </a>\n                </li>\n              </ul>\n            </li>\n\n            <li>\n              <a><i class=\"icon ion-iphone inlineicon facilities-dropdown-icon\"></i>SMS\n                <label *ngIf=\"facilites.smsProviders\">({{facilites.smsProviders.length}})</label>\n                <i (click)=\"facilitiesMenuOptions.activeSms=!facilitiesMenuOptions.activeSms\"\n                   class=\"icon ion-chevron-down\"></i><span (click)=\"createFacilities('smsProviders')\"\n                                                           class=\"facilities-create\"><i\n                  class=\"icon ion-android-add-circle inlineicon\"></i>New</span></a>\n              <ul class=\"facilities-dropdown-list\" [ngClass]=\"{expanded: !facilitiesMenuOptions.activeSms}\">\n                <li *ngFor=\"let item of facilites.smsProviders\">\n                  <a>{{item}} <span class=\"facilities-edit-keystore facilities-keystore facilities-edit\" (click)=\"editFacilities('smsProviders', item)\">\n                    <i class=\"icon ion-edit inlineicon\"></i>Edit</span>\n                    <span class=\"facilities-keystore facilities-edit\" (click)=\"deleteFacility('smsProviders', item)\">\n                    <i class=\"icon ion-android-delete inlineicon\"></i>Delete</span>\n                  </a>\n                </li>\n              </ul>\n            </li>\n\n            <li>\n              <a><i class=\"icon ion-email inlineicon facilities-dropdown-icon\"></i>Email\n                <label *ngIf=\"facilites.emailProviders\">({{facilites.emailProviders.length}})</label>\n                <i (click)=\"facilitiesMenuOptions.activeEmail=!facilitiesMenuOptions.activeEmail\"\n                   class=\"icon ion-chevron-down\"></i><span (click)=\"createFacilities('emailProviders')\"\n                                                           class=\"facilities-create\"><i\n                  class=\"icon ion-android-add-circle inlineicon\"></i>New</span></a>\n              <ul class=\"facilities-dropdown-list\" [ngClass]=\"{expanded: !facilitiesMenuOptions.activeEmail}\">\n                <li *ngFor=\"let item of facilites.emailProviders\">\n                  <a>{{item}} <span class=\"facilities-edit-keystore facilities-keystore facilities-edit\" (click)=\"editFacilities('emailProviders', item)\">\n                    <i class=\"icon ion-edit inlineicon\"></i>Edit</span>\n                    <span class=\"facilities-keystore facilities-edit\" (click)=\"deleteFacility('emailProviders', item)\">\n                    <i class=\"icon ion-android-delete inlineicon\"></i>Delete</span>\n                  </a>\n                </li>\n              </ul>\n            </li>\n\n\n            <li>\n              <a><i class=\"icon ion-android-globe inlineicon facilities-dropdown-icon\"></i>HTTP\n                <label *ngIf=\"facilites.httpClients\">({{facilites.httpClients.length}})</label>\n                <i class=\"icon ion-chevron-down\" (click)=\"facilitiesMenuOptions.activeHttp=!facilitiesMenuOptions.activeHttp\"></i>\n                <span class=\"facilities-create\" (click)=\"createFacilities('httpClients')\"><i\n                  class=\"icon ion-android-add-circle inlineicon\"></i>New</span></a>\n              <ul class=\"facilities-dropdown-list\" [ngClass]=\"{expanded: !facilitiesMenuOptions.activeHttp}\">\n                <li *ngFor=\"let item of facilites.httpClients\">\n                  <a>{{item}} <span class=\"facilities-edit-keystore facilities-keystore facilities-edit\" (click)=\"editFacilities('httpClients', item)\">\n                    <i class=\"icon ion-edit inlineicon\"></i>Edit</span>\n                    <span class=\"facilities-keystore facilities-edit\" (click)=\"deleteFacility('httpClients', item)\">\n                    <i class=\"icon ion-android-delete inlineicon\"></i>Delete</span>\n                  </a>\n                </li>\n              </ul>\n            </li>\n\n            <li class=\"facilities-dropdown-list-item\">\n              <a><i class=\"icon ion-code inlineicon facilities-dropdown-icon\"></i>Crypto ({{getCryptoKeysLength()}})\n                <i class=\"icon ion-chevron-down\" (click)=\"facilitiesMenuOptions.activeCrypto=!facilitiesMenuOptions.activeCrypto\"></i>\n              </a>\n              <ul class=\"facilities-dropdown-list\" [ngClass]=\"{expanded: !facilitiesMenuOptions.activeCrypto}\">\n                <li>\n                  <a><i class=\"icon ion-key inlineicon facilities-dropdown-icon\"></i>Server SSL Keys\n                    <label *ngIf=\"facilites.serverSSLKeys\">({{facilites.serverSSLKeys.length}})</label>\n                    <i class=\"icon\" (click)=\"facilitiesMenuOptions.serverSSLKeys=!facilitiesMenuOptions.serverSSLKeys\" [ngClass]=\"{'ion-plus-circled':facilitiesMenuOptions.serverSSLKeys, 'ion-minus-circled':!facilitiesMenuOptions.serverSSLKeys}\"></i>\n                    <span class=\"facilities-create\" (click)=\"createFacilities('generateSslServerKeystore')\"><i\n                      class=\"icon ion-android-add-circle inlineicon\"></i>New</span></a>\n\n                  <ul [ngClass]=\"{'expanded':!facilitiesMenuOptions.serverSSLKeys}\">\n                    <li *ngFor=\"let item of facilites.serverSSLKeys\">\n                      <a>{{item}}\n                        <span class=\"facilities-edit-keystore facilities-keystore facilities-edit\" (click)=\"createFacilities('generateSslServerKeystore', item)\">\n                        <i class=\"icon ion-edit inlineicon\"></i>Edit</span>\n                        <span class=\"facilities-keystore facilities-edit\" (click)=\"deleteFacility('serverSSLKeys', item)\">\n                        <i class=\"icon ion-android-delete inlineicon\"></i>Delete</span>\n                      </a>\n                    </li>\n                  </ul>\n                </li>\n\n                <li>\n                  <a><i class=\"icon ion-key inlineicon facilities-dropdown-icon\"></i>Client SSL Keys\n                    <label *ngIf=\"facilites.clientSSLKeys\">({{facilites.clientSSLKeys.length}})</label>\n                    <i class=\"icon\" (click)=\"facilitiesMenuOptions.clientSSLKeys=!facilitiesMenuOptions.clientSSLKeys\" [ngClass]=\"{'ion-plus-circled':facilitiesMenuOptions.clientSSLKeys, 'ion-minus-circled':!facilitiesMenuOptions.clientSSLKeys}\"></i>\n                    <span class=\"facilities-create\" (click)=\"createFacilities('addSslClientKeystore')\"><i\n                      class=\"icon ion-android-add-circle inlineicon\"></i>New</span></a>\n\n                  <ul [ngClass]=\"{'expanded':!facilitiesMenuOptions.clientSSLKeys}\">\n                    <li *ngFor=\"let item of facilites.clientSSLKeys\">\n                      <a>{{item}}\n                        <span class=\"facilities-edit-keystore facilities-keystore facilities-edit\" (click)=\"createFacilities('addSslClientKeystore', item)\">\n                        <i class=\"icon ion-edit inlineicon\"></i>Edit</span>\n                        <span class=\"facilities-keystore facilities-edit\" (click)=\"deleteFacility('clientSSLKeys', item)\">\n                        <i class=\"icon ion-android-delete inlineicon\"></i>Delete</span>\n                      </a>\n                    </li>\n                  </ul>\n                </li>\n\n                <li>\n                  <a><i class=\"icon ion-key inlineicon facilities-dropdown-icon\"></i>Server Trust Stores\n                    <label *ngIf=\"facilites.serverTrustStores\">({{facilites.serverTrustStores.length}})</label>\n                    <i class=\"icon\" (click)=\"facilitiesMenuOptions.serverTrustStores=!facilitiesMenuOptions.serverTrustStores\" [ngClass]=\"{'ion-plus-circled':facilitiesMenuOptions.serverTrustStores, 'ion-minus-circled':!facilitiesMenuOptions.serverTrustStores}\"></i>\n                    <span class=\"facilities-create\" (click)=\"createFacilities('addSslServerTruststore')\"><i\n                      class=\"icon ion-android-add-circle inlineicon\"></i>New</span></a>\n\n                  <ul [ngClass]=\"{'expanded':!facilitiesMenuOptions.serverTrustStores}\">\n                    <li *ngFor=\"let item of facilites.serverTrustStores\">\n                      <a>{{item}}\n                        <span class=\"facilities-edit-keystore facilities-keystore facilities-edit\" (click)=\"createFacilities('addSslServerTruststore', item)\">\n                        <i class=\"icon ion-edit inlineicon\"></i>Edit</span>\n                        <span class=\"facilities-keystore facilities-edit\" (click)=\"deleteFacility('serverTrustStores', item)\">\n                        <i class=\"icon ion-android-delete inlineicon\"></i>Delete</span>\n                      </a>\n                    </li>\n                  </ul>\n                </li>\n\n                <li>\n                  <a><i class=\"icon ion-key inlineicon facilities-dropdown-icon\"></i>Signing Keys\n                    <label *ngIf=\"facilites.signingKeys\">({{facilites.signingKeys.length}})</label>\n                    <i class=\"icon\" (click)=\"facilitiesMenuOptions.signingKeys=!facilitiesMenuOptions.signingKeys\" [ngClass]=\"{'ion-plus-circled':facilitiesMenuOptions.signingKeys, 'ion-minus-circled':!facilitiesMenuOptions.signingKeys}\"></i>\n                    <span class=\"facilities-create\" (click)=\"createFacilities('generateSigningKeyKeystore')\"><i\n                      class=\"icon ion-android-add-circle inlineicon\"></i>New</span></a>\n\n                  <ul [ngClass]=\"{'expanded':!facilitiesMenuOptions.signingKeys}\">\n                    <li *ngFor=\"let item of facilites.signingKeys\">\n                      <a>{{item}}\n                        <span class=\"facilities-edit-keystore facilities-keystore facilities-edit\" (click)=\"createFacilities('generateSigningKeyKeystore', item)\">\n                        <i class=\"icon ion-edit inlineicon\"></i>Edit</span>\n                        <span class=\"facilities-keystore facilities-edit\" (click)=\"deleteFacility('signingKeys', item)\">\n                        <i class=\"icon ion-android-delete inlineicon\"></i>Delete</span>\n                      </a>\n                    </li>\n                  </ul>\n                </li>\n\n\n                <li>\n                  <a><i class=\"icon ion-key inlineicon facilities-dropdown-icon\"></i>Signature Verification Keys\n                    <label *ngIf=\"facilites.signatureVerificiationKeys\">({{facilites.signatureVerificiationKeys.length}})</label>\n                    <i class=\"icon\" (click)=\"facilitiesMenuOptions.signatureVerificiationKeys=!facilitiesMenuOptions.signatureVerificiationKeys\" [ngClass]=\"{'ion-plus-circled':facilitiesMenuOptions.signatureVerificiationKeys, 'ion-minus-circled':!facilitiesMenuOptions.signatureVerificiationKeys}\"></i>\n                    <span class=\"facilities-create\" (click)=\"createFacilities('addSignatureVerificationKey')\"><i\n                      class=\"icon ion-android-add-circle inlineicon\"></i>New</span></a>\n\n                  <ul [ngClass]=\"{'expanded':!facilitiesMenuOptions.signatureVerificiationKeys}\">\n                    <li *ngFor=\"let item of facilites.signatureVerificiationKeys\">\n                      <a>{{item}}\n                        <span class=\"facilities-edit-keystore facilities-keystore facilities-edit\" (click)=\"createFacilities('addSignatureVerificationKey', item)\">\n                        <i class=\"icon ion-edit inlineicon\"></i>Edit</span>\n                        <span class=\"facilities-keystore facilities-edit\" (click)=\"deleteFacility('signatureVerificiationKeys', item)\">\n                        <i class=\"icon ion-android-delete inlineicon\"></i>Delete</span>\n                      </a>\n                    </li>\n                  </ul>\n                </li>\n\n                <li>\n                  <a><i class=\"icon ion-key inlineicon facilities-dropdown-icon\"></i>Encryption Keys\n                    <label *ngIf=\"facilites.encryptionKeys\">({{facilites.encryptionKeys.length}})</label>\n                    <i class=\"icon\" (click)=\"facilitiesMenuOptions.encryptionKeys=!facilitiesMenuOptions.encryptionKeys\" [ngClass]=\"{'ion-plus-circled':facilitiesMenuOptions.encryptionKeys, 'ion-minus-circled':!facilitiesMenuOptions.encryptionKeys}\"></i>\n                    <span class=\"facilities-create\" (click)=\"createFacilities('addEncryptionKeystore')\"><i\n                      class=\"icon ion-android-add-circle inlineicon\"></i>New</span></a>\n\n                  <ul [ngClass]=\"{'expanded':!facilitiesMenuOptions.encryptionKeys}\">\n                    <li *ngFor=\"let item of facilites.encryptionKeys\">\n                      <a>{{item}}\n                        <span class=\"facilities-edit-keystore facilities-keystore facilities-edit\" (click)=\"createFacilities('addEncryptionKeystore', item)\">\n                        <i class=\"icon ion-edit inlineicon\"></i>Edit</span>\n                        <span class=\"facilities-keystore facilities-edit\" (click)=\"deleteFacility('encryptionKeys', item)\">\n                        <i class=\"icon ion-android-delete inlineicon\"></i>Delete</span>\n                      </a>\n                    </li>\n                  </ul>\n                </li>\n\n                <li>\n                  <a><i class=\"icon ion-key inlineicon facilities-dropdown-icon\"></i>Decryption Keys\n                    <label *ngIf=\"facilites.decryptionKeys\">({{facilites.decryptionKeys.length}})</label>\n                    <i class=\"icon\" (click)=\"facilitiesMenuOptions.decryptionKeys=!facilitiesMenuOptions.decryptionKeys\" [ngClass]=\"{'ion-plus-circled':facilitiesMenuOptions.decryptionKeys, 'ion-minus-circled':!facilitiesMenuOptions.decryptionKeys}\"></i>\n                    <span class=\"facilities-create\" (click)=\"createFacilities('addDecryptionKeystore')\"><i\n                      class=\"icon ion-android-add-circle inlineicon\"></i>New</span></a>\n\n                  <ul [ngClass]=\"{'expanded':!facilitiesMenuOptions.decryptionKeys}\">\n                    <li *ngFor=\"let item of facilites.decryptionKeys\">\n                      <a>{{item}}\n                        <span class=\"facilities-edit-keystore facilities-keystore facilities-edit\" (click)=\"createFacilities('addDecryptionKeystore', item)\">\n                        <i class=\"icon ion-edit inlineicon\"></i>Edit</span>\n                        <span class=\"facilities-keystore facilities-edit\" (click)=\"deleteFacility('decryptionKeys', item)\">\n                        <i class=\"icon ion-android-delete inlineicon\"></i>Delete</span>\n                      </a>\n                    </li>\n                  </ul>\n                </li>\n\n              </ul>\n            </li>\n\n            <li>\n              <a><i class=\"icon ion-iphone inlineicon facilities-dropdown-icon\"></i>Credential Managers\n                <label *ngIf=\"facilites.credentialManagers\">({{facilites.credentialManagers.length}})</label>\n                <i (click)=\"facilitiesMenuOptions.activeCredentialManager=!facilitiesMenuOptions.activeCredentialManager\"\n                   class=\"icon ion-chevron-down\"></i><span (click)=\"createFacilities('credentialManagers')\"\n                                                           class=\"facilities-create\"><i\n                  class=\"icon ion-android-add-circle inlineicon\"></i>New</span></a>\n              <ul class=\"facilities-dropdown-list\" [ngClass]=\"{expanded: !facilitiesMenuOptions.activeCredentialManager}\">\n                <li *ngFor=\"let item of facilites.credentialManagers\">\n                  <a>{{item}} <span class=\"facilities-edit-keystore facilities-keystore facilities-edit\" (click)=\"editFacilities('credentialManagers', item)\">\n                    <i class=\"icon ion-edit inlineicon\"></i>Edit</span>\n                    <span class=\"facilities-keystore facilities-edit\" (click)=\"deleteFacility('credentialManagers', item)\">\n                    <i class=\"icon ion-android-delete inlineicon\"></i>Delete</span>\n                  </a>\n                </li>\n              </ul>\n            </li>\n\n            <li>\n              <a><i class=\"icon ion-android-person inlineicon facilities-dropdown-icon\"></i>Account Managers\n                <label *ngIf=\"facilites.accountManagers\">({{facilites.accountManagers.length}})</label>\n                <i (click)=\"facilitiesMenuOptions.activeAccountManager=!facilitiesMenuOptions.activeAccountManager\"\n                   class=\"icon ion-chevron-down\"></i><span (click)=\"createFacilities('accountManagers')\"\n                                                           class=\"facilities-create\"><i\n                        class=\"icon ion-android-add-circle inlineicon\"></i>New</span></a>\n              <ul class=\"facilities-dropdown-list\" [ngClass]=\"{expanded: !facilitiesMenuOptions.activeAccountManager}\">\n                <li *ngFor=\"let item of facilites.accountManagers\">\n                  <a>{{item}} <span class=\"facilities-edit-keystore facilities-keystore facilities-edit\" (click)=\"editFacilities('accountManagers', item)\">\n                    <i class=\"icon ion-edit inlineicon\"></i>Edit</span>\n                    <span class=\"facilities-keystore facilities-edit\" (click)=\"deleteFacility('accountManagers', item)\">\n                    <i class=\"icon ion-android-delete inlineicon\"></i>Delete</span>\n                  </a>\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </li>\n  </ul>\n</nav>\n<main class=\"container-full dashboard-container clearfix mt0\" role=\"main\">\n  <modal></modal>\n  <profile-modal></profile-modal>\n  <create-authentication-profile-modal (created)=\"onAuthenticationProfileCreated($event)\"></create-authentication-profile-modal>\n  <create-oauth-profile-modal (created)=\"onOAuthProfileCreated($event)\"></create-oauth-profile-modal>\n  <create-user-management-profile-modal (created)=\"onUserManagementProfileCreated($event)\"></create-user-management-profile-modal>\n  <rollbacks></rollbacks>\n  <simple-notifications></simple-notifications>\n  <app-changes></app-changes>\n  <about-modal></about-modal>\n  <endpoint-deployment-modal></endpoint-deployment-modal>\n  <router-outlet></router-outlet>\n  <facilities-modal (created)=\"onFacilityCreated($event)\"></facilities-modal>\n  <http-clients-modal (created)=\"onFacilityCreated($event)\"></http-clients-modal>\n  <download-config-modal (closed)=\"onDownloadConfigModalClosed($event)\"></download-config-modal>\n  <commit-modal></commit-modal>\n  <alert-modal></alert-modal>\n  <confirm-modal (confirmed)=\"confirmed($event)\"></confirm-modal>\n  <abort-modal (confirmed)=\"confirmed($event)\"></abort-modal>\n  <app-certificate-modal (created)=\"onFacilityCreated($event)\"></app-certificate-modal>\n  <shortcuts-modal></shortcuts-modal>\n  <deployment-modal></deployment-modal>\n  <app-trust-store-modal (created)=\"onFacilityCreated($event)\"></app-trust-store-modal>\n  <confirm-dialog></confirm-dialog>\n  <server-reconnect-modal></server-reconnect-modal>\n</main>\n\n<div class=\"help-icon\">\n  <div class=\"dropdown dropdown-help\">\n\t<button class=\"dropbtn\">\n\t\t<i class=\"icon ion-help-circled\"></i>\n\t</button>\n\t<div class=\"dropdown-content\">\n\t\t<a data-href=\"/admin/docs\" (click)=\"opendocs()\" target=\"docs\" id=\"open-docs\">\n\t\t\tView docs</a>\n\t\t<a (click)=\"onShortCuts()\">\n\t\t\tShortcuts </a>\n\t\t<a (click)=\"onAbout()\">\n\t\t\tAbout</a>\n\t</div>\n  </div>\n</div>\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/app/main.component.html	(revision 05849a5cdc1eac7ea803874310c7b841c91ba6bd)
+++ src/app/main.component.html	(date 1538982219000)
@@ -20,7 +20,7 @@
         <span class="dropbtn-labe dropbtn-label-authentication">Authentication</span>
         </button>
         <div class="dropdown-content">
-          <a class="dropdown-create dropdown-create-separator-bottom" (click)="createAuthenticationProfile()"><i class="icon ion-plus-circled inlineicon"></i> New profile</a>
+          <a appReadOnlyMode class="dropdown-create dropdown-create-separator-bottom" (click)="createAuthenticationProfile()"><i class="icon ion-plus-circled inlineicon"></i> New profile</a>
           <div *ngFor="let profile of result">
             <a *ngIf="profile.type.indexOf('authentication')>-1"
                [ngClass]="{'active': profile.id === currentProfileId}"
Index: src/app/system/components/overview/overview.component.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><header class=\"dashboard-header mt2 py2\">\n  <div class=\"container clearfix\">\n    <div class=\"sm-col sm-col-6\">\n      <h1 class=\"mt0\">Overview</h1>\n    </div>\n    <div class=\"sm-col sm-col-6 clearfix\">\n      <div class=\"sm-col sm-col-6 px2 right-align\">\n        <div class=\"dashboard-stats\">\n          <span>{{deployments.length}}</span>\n          servers deployed\n        </div>\n      </div>\n      <div class=\"sm-col sm-col-6 px2 right-align\">\n        <div class=\"dashboard-stats\">\n          <span>{{profiles.length}}</span>\n          profiles active\n        </div>\n      </div>\n    </div>\n  </div>\n</header>\n\n<div class=\"container clearfix\">\n  <div class=\"sm-col sm-col-12 py2 dashboard-table-header\">\n    <div class=\"sm-col sm-col-6\">\n      <h2 class=\"mt0 white\">\n        <span class=\"inlineicon\"><img src=\"assets/images/deployments-icon.svg\" alt=\"deployments\"></span>\n        Deployments\n      </h2>\n    </div>\n    <div class=\"sm-col sm-col-6 right-align\">\n      <a (click)=\"createDeployment()\"\n         class=\"button button-small button-success\" role=\"button\"><i class=\"icon ion-plus inlineicon\"></i>New Server</a>\n    </div>\n  </div>\n  <table class=\"table inline-table inline-table-dark\" style=\"height: auto\">\n    <thead>\n      <tr>\n        <th>ID</th>\n        <th>Listening Host</th>\n        <th>Listening Port</th>\n        <th>Uptime</th>\n        <th>Enabled</th>\n        <th class=\"table-action right-align\">Actions</th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr *ngFor=\"let item of deployments | orderBy: ['id']\">\n        <td>{{item.values['id']}}</td>\n        <td>{{item.values['listening-host']}}</td>\n        <td>{{item.values['listening-port']}}</td>\n        <td>{{item.values['uptime']}}</td>\n        <td><label class=\"toggle-switch\">\n          <input type=\"checkbox\"\n                 (change)=\"updateDeploymentEnabled(!(item.values['enabled']),deploymentsUrl+'{'+item.values['id']+'}/enabled',item.values['id'])\"\n                 [checked]=\"item.values['enabled']\">\n          <div class=\"toggle-slider round\"></div>\n        </label></td>\n        <td class=\"table-action\">\n          <button (click)=\"updateDeployment(item.values['id'])\" class=\"button button-small button-primary-outline\">View <i class=\"icon ion-chevron-right inlineicon inlineicon-right\"></i></button>\n        </td>\n      </tr>\n    </tbody>\n  </table>\n</div>\n\n<div class=\"container clearfix\">\n  <div class=\"sm-col sm-col-12 py2 dashboard-table-header mt2\">\n    <div class=\"sm-col sm-col-6\">\n      <h2 class=\"mt0 white\">\n        <span class=\"inlineicon\"><img src=\"assets/images/profiles-icon.svg\" alt=\"deployments\"></span>\n        Profiles\n      </h2>\n    </div>\n    <div class=\"sm-col sm-col-6 right-align\">\n      <a (click)=\"createProfile()\"\n         class=\"button button-small button-success\" role=\"button\"><i class=\"icon ion-plus inlineicon\"></i>New Profile</a>\n    </div>\n  </div>\n  <table class=\"table inline-table inline-table-dark\" style=\"height: auto\">\n    <thead>\n      <tr>\n        <th>Name</th>\n        <th>Type</th>\n        <th class=\"table-action right-align\">Actions</th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr *ngFor=\"let item of profiles | orderBy:['type']\">\n        <td>{{item.id | capitalize}}</td>\n        <td>{{item.type}}</td>\n        <td class=\"table-action\">\n          <button (click)=\"navigateToProfile(item)\"\n                  class=\"button button-small button-primary-outline\">View\n            <i class=\"icon ion-chevron-right inlineicon inlineicon-right\"></i>\n          </button>\n        </td>\n      </tr>\n    </tbody>\n  </table>\n</div>\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/app/system/components/overview/overview.component.html	(revision 05849a5cdc1eac7ea803874310c7b841c91ba6bd)
+++ src/app/system/components/overview/overview.component.html	(date 1538735655000)
@@ -29,8 +29,8 @@
       </h2>
     </div>
     <div class="sm-col sm-col-6 right-align">
-      <a (click)="createDeployment()"
-         class="button button-small button-success" role="button"><i class="icon ion-plus inlineicon"></i>New Server</a>
+      <button appReadOnlyMode (click)="createDeployment()"
+         class="button button-small button-success" role="button"><i class="icon ion-plus inlineicon"></i>New Server</button>
     </div>
   </div>
   <table class="table inline-table inline-table-dark" style="height: auto">
